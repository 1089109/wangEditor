<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>upload image demo</title>
  <link href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet">
  <style>
    #editor-toolbar {
      border: 1px solid #ccc;
      /* z-index: 100; */
    }

    #editor-text-area {
      border: 1px solid #ccc;
      height: 550px;
      /* overflow: hidden; */
      /* z-index: 100; */
    }
  </style>
  <link href="../dist/css/style.css" rel="stylesheet">
</head>

<body>
  <p>
    upload image
  </p>

  <!-- 编辑器 -->
  <div id="container">
    <div id="editor-toolbar"></div>
    <div style="height: 10px;">
      <!-- 间隔 -->
    </div>
    <div id="editor-text-area"></div>
  </div>


  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="js/init-content.js"></script>
  <script src="../dist/index.js"></script>
  <script>
    wangEditor = window.wangEditor.default

    const editorConfig = { MENU_CONF: {} }
    editorConfig.MENU_CONF['uploadImage'] = {
      server: 'http://106.12.198.214:3000/api/upload-img', // 上传图片地址
      // server: 'http://106.12.198.214:3000/api/upload-img-10s', // 用于测试 timeout
      // server: 'http://106.12.198.214:3000/api/xxx', // 用于测试 404

      timeout: 5 * 1000, // 5s

      fieldName: 'custom-fileName',
      meta: { token: 'xxx' },
      headers: { Accept: 'text/x-json' },

      base64LimitKB: 5, // 5kb 以下插入 base64

      onBeforeUpload(files) {
        console.log('onBeforeUpload', files)

        return files // 返回哪些文件可以上传
        // return false 会阻止上传
      },
      onProgress(progress) {
        console.log('onProgress', progress)
      },
      onSuccess(file, res) {
        console.log('onSuccess', file, res)
      },
      onFailed(file, res) {
        console.log('onFailed', file, res)
      },
      onError(file, err, res) {
        console.error('onError', file, err, res)
      },

      // // 用户自定义插入图片
      // customInsert(res, insertFn) {
      //   console.log('customInsert', res)
      //   const imgInfo = res.data[0] || {}
      //   const { url, alt, href } = imgInfo
      //   if (!url) throw new Error(`Image url is empty`)

      //   // 自己插入图片
      //   console.log('自己插入图片', url)
      //   insertFn(url, alt, href)
      // },

      // // 用户自定义上传图片
      // customUpload(files, insertFn) {
      //   console.log('customUpload', files)

      //   // 插入一张图片，模拟异步
      //   setTimeout(() => {
      //     const src = 'https://www.baidu.com/img/flexible/logo/pc/result@2.png'
      //     insertFn(src, '百度 logo', src)
      //   }, 500)
      // },

      // // 自定义选择图片（如图床）
      // customBrowseAndUpload(insertFn) {
      //   alert('自定义选择图片，如弹出图床')

      //   // 插入一张图片，模拟异步
      //   setTimeout(() => {
      //     const src = 'https://www.baidu.com/img/flexible/logo/pc/result@2.png'
      //     insertFn(src, '百度 logo', src) // 插入图片
      //   }, 500)
      // },
    }

    const editor = wangEditor.createEditor({
      textareaSelector: '#editor-text-area',
      content: window.content1,
      config: editorConfig
    })

    const toolbar = wangEditor.createToolbar({
      editor,
      toolbarSelector: '#editor-toolbar',
      // config: {}
    })
  </script>
</body>

</html>